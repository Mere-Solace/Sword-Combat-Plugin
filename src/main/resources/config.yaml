# ==============================================================================
# Sword: Combat Evolved - Configuration File
# ==============================================================================
# This file externalizes hardcoded values to allow for dynamic tuning without
# recompilation. Values are organized by game system for maintainability.
#
# After editing, reload with: /sword reload
# ==============================================================================

# ==============================================================================
# PHYSICS SYSTEM
# Controls projectile motion, gravity, and velocity calculations
# ==============================================================================
physics:
  # Thrown item projectile physics
  thrown_items:
    # Gravity dampening coefficient
    # Source: ThrownItem.java:214
    # Range: 30-60 (lower = faster fall, higher = floatier arc)
    # Note: 46 approximates realistic gravity at ~20 ticks/second
    gravity_damper: 46.0

    # Trajectory angle adjustment (radians)
    # Source: ThrownItem.java:209
    # Value: π/85 ≈ 0.037 radians ≈ 2.12 degrees
    # Range: π/120 to π/60 (0.026-0.052 rad)
    # Purpose: Slight rightward curve compensation
    trajectory_rotation: 0.03696  # Math.PI/85

    # Initial display position offsets (relative to player eye location)
    # Source: ThrownItem.java:96-98
    # Coordinates in blocks: (right/left, up/down, forward/back)
    display_offset:
      x: -0.5  # Negative = left of player
      y: 0.1   # Above eye level
      z: 0.5   # In front of player

    # Throw origin offsets (eye location adjustments)
    # Source: ThrownItem.java:204-206
    # Applied to basis vectors: [forward, up, right]
    origin_offset:
      forward: 0.5   # Half block ahead
      up: 0.1        # Slightly raised
      back: -0.25    # Quarter block adjustment

    # Rotation speeds per tick for different item types (radians/tick)
    # Source: ThrownItem.java:273-279
    # Visual effect only, doesn't affect physics
    rotation_speed:
      sword: 0.0              # Swords don't rotate (stay pointed forward)
      axe: -0.39269908169     # -π/8 per tick (fast tumble)
      hoe: -0.39269908169     # -π/8 per tick
      pickaxe: -0.39269908169 # -π/8 per tick
      shovel: -0.39269908169  # -π/8 per tick
      shield: -0.39269908169  # -π/8 per tick (X-axis rotation)
      default: 0.09817477042  # π/32 per tick (gentle spin)

  # Attack velocity modifications
  attack_velocity:
    # Velocity dampening when performing grounded attacks
    # Source: AttackAction.java:169-172
    # Multiplies current velocity to slow player during swing
    grounded_damping:
      horizontal: 0.3  # 70% speed reduction on X/Z axes
      vertical: 0.4    # 60% speed reduction on Y axis

    # Knockback base values
    # Source: AttackAction.java:221
    knockback:
      vertical_base: 0.25      # Base upward launch
      horizontal_modifier: 0.1  # Directional adjustment per attack
      normal_multiplier: 0.7    # Default knockback magnitude

# ==============================================================================
# COMBAT SYSTEM
# Damage calculations, hitboxes, attack patterns, and combat mechanics
# ==============================================================================
combat:
  # Basic melee attack parameters
  attacks:
    # Base damage value (before modifiers)
    # Source: AttackAction.java:110
    # Range: 10-30 (Minecraft hearts: 5-15)
    # Note: Final damage affected by aspects/stats
    base_damage: 20.0

    # Attack range multipliers by type
    # Source: AttackAction.java:121-138
    # Multiplied against base reach to determine hitbox range
    # Golden ratio (φ ≈ 1.618) appears near these values
    range_multipliers:
      basic_1: 1.4      # First combo hit
      basic_2: 1.4      # Second combo hit
      basic_3: 1.4      # Third combo hit (finisher)
      neutral_air: 1.3  # Aerial attack
      down_air: 1.2     # Downward aerial spike

    # Down-air attack trigger threshold
    # Source: AttackAction.java:69
    # Dot product of look direction vs UP vector
    # -1.0 = looking straight down, 0.0 = horizontal, 1.0 = straight up
    # Range: -1.0 to 0.0 (currently triggers at 30° below horizon)
    down_air_threshold: -0.5

    # Cast duration calculation (affects attack speed)
    # Source: AttackAction.java:91
    # Formula: calcValueReductive(FINESSE, min, max, reduction_rate)
    cast_timing:
      min_duration: 1    # Minimum ticks (20 ticks = 1 second)
      max_duration: 3    # Maximum ticks
      reduction_rate: 0.2  # How much FINESSE stat reduces duration

    # Attack duration multiplier for animation/cooldown
    # Source: AttackAction.java:107
    # Multiplies cast_duration (ticks) to get milliseconds
    duration_multiplier: 500

  # Hitbox detection settings
  hitboxes:
    # Secant method detection radius
    # Source: AttackAction.java:225
    # Radius around attack path to check for entities (in blocks)
    # Range: 0.3-0.6 (0.3 = precise, 0.6 = generous)
    # Note: 0.4 = 40cm radius, roughly arm's reach
    secant_radius: 0.4

    # Ray trace settings for thrown items
    # Source: ThrownItem.java:456, 479
    thrown_item:
      # Collision detection uses initial_velocity as max distance
      # Hitbox radius for entity detection
      entity_radius: 0.5
      # Whether to check fluid collisions
      check_fluids: false

  # Thrown item combat values
  thrown_damage:
    # Impalement damage and knockback
    # Source: ThrownItem.java:375, 424
    # Format: hit(source, invuln_ticks, shards, toughness_dmg, soulfire_reduction, knockback)
    sword_axe:
      invulnerability_ticks: 0     # No iframes on hit
      base_shards: 2                # Shard damage component
      toughness_damage: 75.0        # Armor penetration value
      soulfire_reduction: 50.0      # Resource drain on hit
      knockback_grounded: 0.7       # Multiplier if target on ground
      knockback_airborne: 1.0       # Multiplier if target in air

    # Non-bladed thrown items (tools, blocks)
    other:
      invulnerability_ticks: 0
      base_shards: 2
      toughness_damage: 75.0
      soulfire_reduction: 50.0
      knockback_multiplier: 0.7
      explosion_power: 1.0          # Blast radius on impact

  # Impalement mechanic (weapons sticking to enemies)
  # Source: ThrownItem.java:544-555
  impalement:
    # Ratio of entity height that determines head vs body hit
    # 0.8 = top 20% of entity is "head" zone
    # Range: 0.6-0.9 (affects head-follow behavior)
    head_zone_ratio: 0.8

    # Entities that never use head-following (always body-locked)
    # Source: ThrownItem.java:553
    head_follow_exceptions:
      - SPIDER      # Low-profile mob

    # Pin duration when enemy is stuck to wall
    # Source: ThrownItem.java:395
    # Measured in iterations (50 iter × 2 ticks = 100 ticks = 5 seconds)
    pin_max_iterations: 1000
    pin_check_interval: 2  # Ticks between pin checks

  attack_class:
    modifiers:
      range_multiplier: 3.5

    # Timing configuration (in milliseconds)
    # These control how long each attack phase lasts.
    # Each phase determines when Bezier motion or entity effects occur.
    # --------------------------------------------------------------------------
    timing:

      # Source: Attack.java:74
      # Duration of windup phase before the weapon swing
      # Affects anticipation and player vulnerability
      windup_duration: 500

      # Source: Attack.java:75
      # Number of intermediate updates during the windup phase
      # More iterations = smoother motion, but more scheduler load
      windup_iterations: 20

      # Source: Attack.java:76–77
      # Start/end values (t-parameters) of the Bezier motion curve
      # Controls how far along the swing path the windup travels visually
      windup_start_value: 0.25
      windup_end_value: -0.05

      # Source: Attack.java:78
      # Active swing duration
      # Determines how long the attack hitbox is active
      attack_duration: 300

      # Source: Attack.java:79
      # Number of iterations (frames) during attack phase
      # Typically fewer than windup for faster apparent motion
      attack_iterations: 10

      # Source: Attack.java:80–81
      # Start/end Bezier parameters for swing path (0=start, 1=end)
      attack_start_value: 0.0
      attack_end_value: 1.0

      # Source: Attack.java:82
      # Time before next action can begin (recovery period)
      # Prevents immediate chaining; affects combo pacing
      recovery_duration: 250


    # Visual transformation configuration
    # These determine how the ItemDisplay representing the weapon
    # is scaled and oriented in space.
    # --------------------------------------------------------------------------
    display:

      offset:
        x: 0
        y: 0
        z: 1.0

      # Source: Attack.java:128–133
      # Scale of the weapon ItemDisplay
      # (x, y, z) multipliers relative to the item’s model size
      # Larger values exaggerate weapon reach visually
      scale:
        x: 2.0
        y: 2.5
        z: 2.0

      # Source: Attack.java:129
      # Rotation applied to the display for alignment
      # π/2 (≈1.5708) corresponds to a 90° rotation
      rotation_y: 0   # radians
      rotation_z: 0   # radians
      rotation_x: 1.5708   # radians

      # Glow outline color for active attack
      # Source: Attack.java:127
      glow_color: "#000000"

      attack_glow_color: "#FF0000"


    # Movement & interpolation configuration
    # These affect the smoothness and responsiveness of weapon visuals.
    # --------------------------------------------------------------------------
    motion:

      # Source: Attack.java:188, 231
      # Number of interpolation steps for smooth teleportation
      # Higher = smoother motion but slightly higher overhead
      display_smooth_steps: 3


    # Self-applied effects during windup
    # Source: Attack.java:158
    # --------------------------------------------------------------------------
    effects:

      # Potion effect applied during windup to simulate slower movement
      # Duration = windup_duration / 50 (ticks per second)
      # Amplifier: 1 → Slowness II
      windup_slowness_amplifier: 4

      attack_slowness_amplifier: 7

# ==============================================================================
# DISPLAY & VISUAL EFFECTS
# Particle systems, animations, teleportation, and rendering
# ==============================================================================
display:
  # Smooth teleportation for entity displays
  # Source: DisplayUtil.java:16
  # Bukkit teleport interpolation duration
  # Range: 1-5 ticks (1 = instant, 5 = very smooth but laggy)
  # Note: 2 ticks ≈ 100ms at 20 TPS (golden standard for responsiveness)
  default_teleport_duration: 2

  # Item display following behavior
  # Source: EntityUtil.java:73-95
  item_display_follow:
    # Update frequency (ticks between position updates)
    # Source: EntityUtil.java:95
    # Fibonacci sequence: 1, 1, 2, 3, 5, 8... (2 chosen for smooth motion)
    update_interval: 2

    # Particle display frequency
    # Source: EntityUtil.java:90-91
    # Displays particle every N ticks (4 = 5 times/second)
    particle_interval: 4

    # Billboard mode for display orientation
    # Options: FIXED, VERTICAL, HORIZONTAL, CENTER
    billboard_mode: FIXED

  # Particle effects configuration
  # Note: Detailed particle configs will be migrated in Phase 3
  particles:
    # Bleed effect intervals (combat visuals)
    # Source: EntityUtil.java:76-78
    bleed:
      line_length: 0.75    # Particle line length (blocks)
      line_width: 0.25     # Spacing between particles
      stick_length: 0.3    # Length when stuck
      stick_width: 0.25    # Spacing when stuck

    # Thrown item trail particles
    # Source: ThrownItem.java:248-250
    trail:
      display_interval: 1       # Every tick
      block_trail_interval: 3   # Every 3 ticks for block items

    # Grounded item marker particles
    # Source: ThrownItem.java:350-352
    grounded_marker:
      update_interval: 5   # Ticks between updates (Fibonacci: 5)
      offset_step: 0.1     # Distance between marker points

  # Bezier curve visualization for attacks
  # Source: AttackAction.java:112
  bezier:
    # Number of steps in cubic Bezier path
    # Range: 30-100 (higher = smoother but more expensive)
    # Note: 50 = good balance (10 steps per combat tick at 5-tick duration)
    num_steps: 50

    # Particle density thresholds (% along attack path)
    # Source: AttackAction.java:193-218
    # Each threshold adds more particle layers for visual intensity
    particle_thresholds:
      layer_1: 0.1    # 10% - start showing trailing particles
      layer_2: 0.3    # 30% - add second layer
      layer_3: 0.5    # 50% - add third layer (halfway point)
      layer_4: 0.625  # 62.5% - note: 5/8 ratio (golden-ish)
      layer_5: 0.75   # 75% - maximum visual intensity

# ==============================================================================
# DETECTION & COLLISION
# Ground detection, entity detection, ray tracing
# ==============================================================================
detection:
  # Ground proximity detection
  # Source: EntityUtil.java:29
  ground_check:
    # Maximum downward distance to check for solid blocks
    # Range: 0.1-0.5 blocks (0.3 handles stairs/slabs well)
    # Note: 0.3 blocks ≈ 30cm, roughly foot height
    max_distance: 0.3

    # Block check offset positions
    # Currently checks single center point (0,0)
    # Future: Could expand to corners for better detection
    offsets:
      - x: 0.0
        z: 0.0

# ==============================================================================
# TIMING & COOLDOWNS
# Grace periods, timeouts, delays, and duration values
# ==============================================================================
timing:
  # Thrown item timing configurations
  thrown_items:
    # Grace period before thrower can catch their own throw
    # Source: ThrownItem.java:475
    # Measured in ticks (20 = 1 second)
    # Purpose: Prevents immediate re-catch exploits
    catch_grace_period: 20

    # Disposal timeout for grounded items
    # Source: ThrownItem.java:345
    # Items disappear after this many ticks if not collected
    # 1000 ticks = 50 seconds (Fibonacci: nearby 987 or 1597)
    disposal_timeout: 1000

    # Disposal check interval
    # Source: ThrownItem.java:356
    # Fibonacci: 5 ticks = 4 checks/second
    disposal_check_interval: 5

    # Delay before impalement disposal check
    # Source: ThrownItem.java:407
    pin_delay: 3  # Small delay for physics to settle

    # Throw animation timing
    # Source: ThrownItem.java:185
    throw_completion_delay: 2  # Ticks after throw before reset

  # Attack timing windows
  attacks:
    # Delay before marking attack as completed
    # Affects combo window timing
    # Source: AttackAction.java:91 (cast_duration)
    # Note: Dynamic based on FINESSE stat (1-3 ticks base)
    combo_window_base: 3  # Maximum ticks for slowest attack

  # Update intervals for various systems
  intervals:
    # General-purpose task intervals (ticks)
    item_motion_update: 1      # ThrownItem physics loop
    display_follow_update: 2   # ItemDisplay following
    pin_check: 2               # Pin stability check
    marker_particle: 5         # Grounded item markers
    impalement_check: 1        # Stuck item validation

# ==============================================================================
# AUDIO
# Sound effect parameters (volume, pitch)
# ==============================================================================
audio:
  # Throw sound effect
  # Source: ThrownItem.java:188
  throw:
    sound: ENTITY_ENDER_DRAGON_FLAP
    volume: 0.35   # Range: 0.0-1.0 (50% volume)
    pitch: 0.4    # Range: 0.5-2.0 (lower = deeper sound)

  # Attack swing sound
  # Source: AttackAction.java:104
  attack:
    sound: ITEM_TRIDENT_THROW
    volume: 0.055
    pitch: 1.5

# ==============================================================================
# ENTITY BEHAVIOR
# Movement modifiers, slowness effects, entity-specific settings
# ==============================================================================
entities:
  # Throw preparation slowness
  # Source: ThrownItem.java:160
  throw_preparation:
    # Applies SLOWNESS effect while holding item ready to throw
    effect: SLOWNESS
    duration: 1      # Ticks (refreshed every tick)
    amplifier: 2     # Slowness II (40% speed)

  # Rotation behavior for impaled entities
  # Source: ThrownItem.java:389-400
  pinned_rotation:
    # Whether to lock entity body rotation when pinned
    lock_rotation: true
    # Velocity reset (prevents movement)
    reset_velocity: true

  # Default combat profile stat values
  # Source: CombatProfile.java:84, 95-99
  # Controls base RPG stats for entities (SHARDS, TOUGHNESS, SOULFIRE, FORM)
  # Format: ResourceValue(current, regenPeriod, regenAmount)
  combat_profile:
    # SHARDS: Primary combat resource for abilities
    # Format: ResourceValue(current, regenPeriod, regenAmount)
    # current: Initial/starting value
    # regen_period: Ticks between regeneration (20 ticks = 1 second)
    # regen_amount: Amount restored per regen period
    shards:
      current: 6
      regen_period: 400       # Regenerates every 10 seconds
      regen_amount: 1.0

    # TOUGHNESS: Damage resistance and armor
    # Format: ResourceValue(current, regenPeriod, regenAmount)
    toughness:
      current: 40
      regen_period: 20       # Regenerates every 1 second
      regen_amount: 0.5

    # SOULFIRE: Special energy resource
    # Format: ResourceValue(current, regenPeriod, regenAmount)
    soulfire:
      current: 100
      regen_period: 5        # Regenerates every 0.25 seconds (fast)
      regen_amount: 0.2

    # FORM: Stance and positioning resource
    # Format: ResourceValue(current, regenPeriod, regenAmount)
    form:
      current: 10
      regen_period: 60       # Regenerates every 3 seconds
      regen_amount: 1.0

    # Maximum consecutive air dodges before landing
    # Source: CombatProfile.java:84
    # Default: 1 (single air dodge)
    # Increased by ability upgrades
    max_air_dodges: 1

# ==============================================================================
# MOVEMENT SYSTEM
# Dash mechanics, toss actions, and movement physics
# ==============================================================================
movement:
  # Dash action configuration
  # Source: MovementAction.java:47-152
  dash:
    # Range and casting
    max_distance: 10.0           # Maximum dash/target detection range (blocks)
    cast_duration: 5             # Cast time in ticks
    base_power: 0.7              # Base dash velocity multiplier

    # Position offsets
    initial_offset_y: 0.3        # Y offset for initial position check
    impedance_check_offset_y: 0.5  # Y offset for block impedance ray trace
    forward_multiplier: 0.5      # Velocity multiplier for forward/backward dash
    upward_multiplier: 0.15      # Upward velocity boost multiplier
    upward_boost: 0.05           # Additional upward velocity on grounded dash

    # Detection and hitboxes
    ray_hitbox_radius: 0.7       # Radius for ray trace entity detection
    secant_radius: 0.3           # Secant particle display radius
    grab_distance_squared: 8.5   # Distance threshold for successful item grab
    block_check_offset_y: -0.75  # Y offset for ground block check

    # Velocity adjustments
    velocity_damping: 0.6        # Velocity damping factor when dash fails

    # Timing configuration (all in ticks)
    particle_task_delay: 0       # Initial delay before particle task
    particle_task_period: 2      # Ticks between particle updates
    particle_timer_increment: 2  # Increment value for particle timer
    particle_timer_threshold: 4  # Timer threshold to cancel particle task
    grab_check_delay: 4          # Delay before checking if grab was successful
    velocity_task_delay: 0       # Initial delay for velocity application
    velocity_task_period: 1      # Ticks between velocity applications

    # Particle effects
    particle_count: 100          # Number of DUST_PILLAR particles on successful grab
    particle_spread_x: 1.25      # Particle spread on X axis
    particle_spread_y: 1.25      # Particle spread on Y axis
    particle_spread_z: 1.25      # Particle spread on Z axis

    # Sound effects
    flap_sound_volume: 0.6       # Volume for ENDER_DRAGON_FLAP sound
    flap_sound_pitch: 1.0        # Pitch for ENDER_DRAGON_FLAP sound
    sweep_sound_volume: 0.3      # Volume for PLAYER_ATTACK_SWEEP sound
    sweep_sound_pitch: 0.6       # Pitch for PLAYER_ATTACK_SWEEP sound

  # Toss action configuration
  # Source: MovementAction.java:164-229
  toss:
    # Force and power
    base_force: 1.5                    # Base toss force
    might_multiplier_base: 2.5         # Base multiplier for MIGHT stat calculation
    might_multiplier_increment: 0.1    # Increment per MIGHT level

    # Velocity phases (iterations and values)
    upward_phase_iterations: 2         # Number of ticks for upward velocity phase
    upward_velocity_y: 0.25            # Y velocity during upward phase
    forward_phase_iterations: 3        # Number of ticks for forward velocity phase
    animation_iterations: 15           # Total animation/check iterations

    # Position and offset multipliers
    location_offset_multiplier: 0.3    # Eye height multiplier for location offset
    particle_height_multiplier: 0.5    # Eye height multiplier for particle display
    ray_trace_distance_multiplier: 0.6 # Eye height multiplier for ray trace distance

    # Collision detection
    entity_detection_radius: 0.4       # Radius for nearby entity detection
    knockback_multiplier: 0.3          # Knockback force multiplier on collision

    # Damage and impact
    explosion_power: 2.0               # Explosion power on impact
    hit_invulnerability_ticks: 3       # Invulnerability ticks after hit
    hit_shard_damage: 2                # Shard damage value
    hit_toughness_damage: 30.0         # Toughness damage value
    hit_soulfire_reduction: 5.0        # Soulfire reduction value

# ==============================================================================
# WORLD INTERACTION
# Block detection, marker placement, explosion settings
# ==============================================================================
world:
  # Grounded item marker placement
  # Source: ThrownItem.java:319-324
  marker_placement:
    # Step size for finding valid placement (blocks)
    pullback_step: 0.1
    # Maximum iterations to find non-solid location
    max_pullback_iterations: 30

  # Explosion settings for non-bladed thrown items
  # Source: ThrownItem.java:425
  explosions:
    power: 1.0             # Blast radius
    set_fire: false        # Don't ignite blocks
    break_blocks: false    # Don't destroy terrain

# ==============================================================================
# DEVELOPER / DEBUG
# Testing values, experimental features, performance tuning
# ==============================================================================
debug:
  # Enable verbose logging for config reloads
  verbose_reload: false

  # Performance monitoring
  # Track timing for expensive operations
  profile_bezier_generation: false
  profile_hitbox_detection: false

  # Visual debugging aids
  show_hitbox_particles: false
  show_bezier_control_points: false

# ==============================================================================
# NOTES & REFERENCES
# ==============================================================================
# Math Constants Used:
#   π (Pi) ≈ 3.14159265359
#   φ (Phi/Golden Ratio) ≈ 1.618033988749
#   Fibonacci Sequence: 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233...
#
# Minecraft Time Reference:
#   1 tick = 50ms (at 20 TPS)
#   20 ticks = 1 second
#   1200 ticks = 1 minute
#
# Common Game Design Values:
#   0.3-0.5: Typical reaction time windows (seconds)
#   2-3: "Rule of thirds" for difficulty/intensity scaling
#   5-7: Magic number for comfortable choice count
#   0.618/1.618: Golden ratio for pleasing proportions
#
# Sources:
#   - Minecraft Wiki: https://minecraft.wiki/w/Tick
#   - Game Programming Patterns: http://gameprogrammingpatterns.com/
#   - The Art of Game Design (Schell): Lens of Balance
# ==============================================================================
